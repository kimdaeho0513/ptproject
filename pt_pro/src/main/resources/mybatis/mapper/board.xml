<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace ="boardMapper">
 <select id="selectData" resultType="boardDto">
 SELECT *
 FROM ttdboard
 WHERE dataNum = #{dataNum}
  AND deleted='N'
  ORDER BY dataNum DESC
</select>


 <select id="dataDetail" resultType="boardDto">
SELECT *
 FROM ttdboard
 WHERE dataNum =#{dataNum}
  AND deleted='N'
</select>

 <select id="selectBoard" resultType="boardDto">
SELECT ROWNUM AS rn
  	  ,writer
      ,title
      ,dataNum
      ,contents
      ,writedate
      ,conut
      ,recommend,liked
  FROM ttdboard
WHERE category=#{category}
  AND deleted='N'
  ORDER BY dataNum DESC
</select>

<select id="getNextSeq" resultType="_int">
SELECT tt_brd_seq.NEXTVAL FROM DUAL
</select>

<select id="se" resultType="boardDto">
SELECT ROWNUM AS RN
  	  ,writer
      ,title
      ,dataNum
      ,contents
      ,writedate
      ,conut
      ,recommend,liked
FROM ttdboard
WHERE UPPER(#{type1}) LIKE UPPER(%#{ID}%) 
  AND category=#{category}
  AND deleted='N'
 </select>

 
 <update id="dataModify" parameterType="boardDto">
UPDATE TOTAL_BOARD
   SET b_CONTENTS = '#{contents}',
       b_TITLE = '#{title}'
 WHERE b_WRITER = '#{dataNum}'
 </update>
 <select id="searchKeyword" resultType="boardDto">
 SELECT * 
FROM ttdboard
WHERE (lower(title) LIKE lower('%'||#{keyword}||'%')
   OR lower(contents) LIKE lower('%'||#{keyword}||'%'))
   AND category=#{category}
   AND deleted='N'
 </select>
 
 
  <select id="searchWriter" resultType="boardDto">
 SELECT * 
FROM ttdboard
WHERE lower(writer) LIKE lower('%'||#{keyword}||'%')
   AND category=#{category}
   AND deleted='N'
 </select>
 
 
 
<insert id="dataAdd" parameterType="boardDto">
INSERT INTO TOTAL_BOARD
 		(b_NUM,
 		b_WRITER,
 		 b_TITLE,
 		 b_CONTENTS,
 		 CATEGORY,
 		 b_WRITEDATE
		 ) 
	VALUES(#{dataNum},#{writer}, #{title}, #{contents}, #{category},SYSDATE)
</insert>
 
 
 
 
 <update id="deleteData">
	update FROM TOTAL_BOARD
	   set deleted='y'
	 WHERE ID = #{dateNum}
</update>
  	<update id="deleteStaticsData">
		update FROM TOTAL_BOARD_REPLY
		 WHERE r_WRITER = #{r_WRITER}
	</update>
</mapper>